{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Membrain-Seg","text":"<p>Membrain-Seg is a Python project developed by teamtomo for membrane segmentation in 3D in 3D for cryo-electron tomography (cryo-ET). This tool aims to provide researchers with an efficient and reliable method for segmenting membranes in 3D microscopic images. Membrain-Seg is currently under early development, so we may make breaking changes between releases.</p>"},{"location":"#overview","title":"Overview","text":"<p>MemBrain-seg is a practical tool for membrane segmentation in cryo-electron tomograms. It's built on the U-Net architecture and makes use of a pre-trained model for efficient performance.</p> <p>If you wish, you can also train a new model using your own data, or combine it with our available public dataset.</p> <p>To enhance segmentation, MemBrain-seg includes preprocessing functions. These help to adjust your tomograms so they're similar to the data our network was trained on, making the process smoother and more efficient.</p> <p>Explore MemBrain-seg, use it for your needs, and let us know how it works for you!</p>"},{"location":"#installation","title":"Installation","text":"<p>For detailed installation instructions, please look here.</p>"},{"location":"#features","title":"Features","text":""},{"location":"#segmentation","title":"Segmentation","text":"<p>Segmenting the membranes in your tomograms is the main feature of this repository.  Please find more detailed instructions here.</p>"},{"location":"#model-training","title":"Model training","text":"<p>... explaination tbd. ...</p>"},{"location":"#preprocessing","title":"Preprocessing","text":"<p>Currently, we provide the following two preprocessing options: - pixel size matching: Rescale your tomogram to match the training pixel sizes - Fourier amplitude matching: Scale Fourier components to match the \"style\" of different tomograms</p> <p>For more information, see the Preprocessing subsection.</p>"},{"location":"installation/","title":"Installation","text":"<p>These installation instructions are very preliminary, and surely will not work on all systems. But if any problems come up, do not hesitate to contact us (lorenz.lamm@helmholtz-munich.de).</p>"},{"location":"installation/#step-1-clone-repository","title":"Step 1: Clone repository","text":"<p>Make sure to have git installed, then run <pre><code>git clone https://github.com/teamtomo/membrain-seg.git\n</code></pre></p>"},{"location":"installation/#step-2-create-a-virtual-environment","title":"Step 2: Create a virtual environment","text":"<p>Before running any scripts, you should create a virtual Python environment. In these instructions, we use Miniconda for managing your virtual environments, but any alternative like Conda, Mamba, virtualenv, venv, ... should be fine.</p> <p>If you don't have any, you could install Miniconda from the official website.</p> <p>Now you can create a new virtual environment using <pre><code>conda create --name &lt;env_name&gt; python=3.9\n</code></pre></p> <p>In order to use it, you need to activate the environment: <pre><code>conda activate &lt;env_name&gt;\n</code></pre></p>"},{"location":"installation/#step-3-install-membrain-seg-and-its-dependencies","title":"Step 3: Install MemBrain-seg and its dependencies","text":"<p>Move to the folder \"membrain-seg\" (from the cloned repository in Step 1) that contains the \"src\" folder. Here, run</p> <pre><code>pip install .\n</code></pre> <p>This will install MemBrain-seg and all dependencies required for segmenting your tomograms.</p>"},{"location":"installation/#step-4-validate-installation","title":"Step 4: Validate installation","text":"<p>As a first check whether the installation was successful, you can run <pre><code>membrain\n</code></pre> This should display the different options you can choose from MemBrain, like \"segment\" and \"train\".</p>"},{"location":"Usage/Preprocessing/","title":"Preprocessing","text":""},{"location":"Usage/Preprocessing/#introduction","title":"Introduction","text":"<p>This is a quick guide on how to use the tomo_preprocessing module for MemBrain-seg. </p> <p>In order to improve the segmentation performance of MemBrain-seg on your tomograms, it may be beneficial to first perform some preprocessing to \"normalize\" the tomograms to similar styles as the training data.</p> <p>This module currently allows you to use the following preprocessing methods:</p> <ul> <li>Pixel size matching: Rescaling of your tomogram to a similar pixel size as the training data</li> <li>Fourier amplitude matching: Rescaling of Fourier components to pronounce different features in the tomograms (adapted from DeePiCt)</li> </ul>"},{"location":"Usage/Preprocessing/#table-of-contents","title":"Table of Contents","text":"<ul> <li>When to use what?</li> <li>Usage</li> <li>Available Commands</li> <li>Pixel Size Matching</li> <li>Fourier Amplitude Matching</li> </ul>"},{"location":"Usage/Preprocessing/#when-to-use-what","title":"When to use what?","text":"<p>We are still exploring when it makes sense to use which preprocessing technique. But here are  already some rules of thumb:</p> <ol> <li>Whenever your pixel sizes differs by a lot from around 10-12\u00c5 / pixel, you should consider using pixel size matching. We recommend to match to a pixel size of 10\u00c5.</li> <li>The Fourier amplitude matching only works in some cases, depending on the CTFs of input  and target tomograms. Our current recommendation is: If you're not satisfied with MemBrain's  segmentation performance, why not give the amplitude matching a shot?</li> </ol> <p>More detailed guidelines are in progress!</p>"},{"location":"Usage/Preprocessing/#usage","title":"Usage","text":"<p>You can control all commands of this preprocessing module by typing <code>tomo_preprocessing</code>+ some options. To view all available commands, use:</p> <pre><code>tomo_preprocessing --help\n</code></pre> <p>For help on a specific command, use:</p> <pre><code>tomo_preprocessing &lt;command&gt; --help\n</code></pre>"},{"location":"Usage/Preprocessing/#available-commands","title":"Available Commands","text":"<ul> <li>match_pixel_size: Tomogram rescaling to specified pixel size. Example: <code>tomo_preprocessing match_pixel_size --input_tomogram &lt;path-to-tomo&gt; --output_path &lt;path-to-output&gt; --pixel_size_out 10.0 --pixel_size_in &lt;your-px-size&gt;</code></li> <li>match_seg_to_tomo: Segmentation rescaling to fit to target tomogram's shape. Example: <code>tomo_preprocessing match_seg_to_tomo --seg_path &lt;path-to-seg&gt; --orig_tomo_path &lt;path-to-tomo&gt; --output_path &lt;path-to-output&gt;</code></li> <li>extract_spectrum: Extracts the radially averaged amplitude spectrum from the input tomogram. Example: <code>tomo_preprocessing extract_spectrum --input_path &lt;path-to-tomo&gt; --output_path &lt;path-to-output&gt;</code></li> <li>match_spectrum: Match amplitude of Fourier spectrum from input tomogram to target spectrum. Example: <code>tomo_preprocessing match_spectrum --input &lt;path-to-tomo&gt; --target &lt;path-to-spectrum&gt; --output &lt;path-to-output&gt;</code></li> </ul>"},{"location":"Usage/Preprocessing/#pixel-size-matching","title":"Pixel Size Matching","text":"<p>Pixel size matching is recommended when your tomogram pixel sizes differs strongly from the training pixel size range (roughly 10-14\u00c5). You can perform it using the command</p> <pre><code>tomo_preprocessing match_pixel_size --input_tomogram &lt;path-to-tomo&gt; --output_path &lt;path-to-output&gt; --pixel_size_out 10.0 --pixel_size_in &lt;your-px-size&gt;\n</code></pre> <p>after adjusting the paths to your respective tomograms. Afterwards, you can perform MemBrain's segmentation on the rescaled tomogram (i.e. the one specified in <code>--output_path</code>). Now, this new segmentation does not have the same shape as the original non-pixel-size-matched tomogram. To rescale the new segmentation to the original tomogram again, you can use</p> <pre><code>tomo_preprocessing match_seg_to_tomo --seg_path &lt;path-to-seg&gt; --orig_tomo_path &lt;path-to-tomo&gt; --output_path &lt;path-to-output&gt;\n</code></pre> <p>where the <code>--seg_path</code>is the segmentation created by MemBrain and the <code>--orig_tomo_path</code>is the original tomogram before rescaling to the new pixel size. The output of this function will be MemBrain's segmentation, but matched to the pixel size of the original tomogram.</p>"},{"location":"Usage/Preprocessing/#fourier-amplitude-matching","title":"Fourier Amplitude Matching","text":"<p>Fourier amplitude matching is performed in two steps:</p> <ol> <li>Extraction of the target Fourier spectrum: <pre><code>tomo_preprocessing extract_spectrum --input_path &lt;path-to-tomo&gt; --output_path &lt;path-to-output&gt;\n</code></pre> This extracts the radially averaged Fourier spectrum and stores it into a .tsv file.</li> <li>Matching of the input tomogram to the extracted spectrum: <pre><code>tomo_preprocessing match_spectrum --input &lt;path-to-tomo&gt; --target &lt;path-to-spectrum&gt; --output &lt;path-to-output&gt;\n</code></pre> Now, the input tomograms Fourier components are re-scaled based on the equalization kernel computed from the input tomogram's radially averaged Fourier intensities, and the previously extracted .tsv file.</li> </ol>"},{"location":"Usage/Segmentation/","title":"Segmentation","text":"<p>Welcome to the central feature of MemBrain-seg: The segmentation of your tomograms!</p> <p>This guide provides detailed instructions to perform segmentation on your tomograms using a pre-trained model.</p>"},{"location":"Usage/Segmentation/#membrain-seg-workflow","title":"MemBrain-seg Workflow","text":"<ol> <li>(Optional) Preprocessing<ul> <li>pixel size matching</li> <li>Fourier amplitude matching</li> </ul> </li> <li>Predict segmentation</li> <li>(Optional) Match pixel size of output segmentation</li> </ol> <p>For the optional preprocessing steps, find more information here</p>"},{"location":"Usage/Segmentation/#preparations","title":"Preparations","text":"<p>For the prediction, you will basically need two files:</p> <ol> <li>The tomogram you would like to segment. It may make sense to use a preprocessed tomogram.</li> <li>A pre-trained MemBrain segmentation model</li> </ol> <p>For point 2, as we are still in the development phase, we do not have a public model right now. If you would like to give MemBrain-seg a try, we are happy to provide our latest model. Just write an email to lorenz.lamm@helmholtz-munich.de</p>"},{"location":"Usage/Segmentation/#prediction","title":"Prediction","text":"<p>Now, for the prediction, you will only need to type</p> <pre><code>membrain segment --tomogram_path &lt;path-to-your-tomo&gt; --ckpt_path &lt;path-to-your-tomo&gt;\n</code></pre> <p>Running this will segment your tomogram, and store the resulting .mrc file into the ./predictions  folder. If you would like to change this folder, you can simply specify another folder using the <code>--out_folder</code> argument:</p> <pre><code>membrain segment --tomogram_path &lt;path-to-your-tomo&gt; --ckpt_path &lt;path-to-your-tomo&gt; --out_folder &lt;your-preferred-folder&gt;\n</code></pre> <p>Note: MemBrain-seg automatically detects a CUDA-enabled GPU, if available, and will execute the segmentation on it. Using a GPU device is highly recommended to accelerate the segmentation process.</p>"},{"location":"Usage/Segmentation/#post-processing","title":"Post-Processing","text":"<p>If you have pre-processed your tomogram using pixel size matching, you may want to rescale your  segmentation back to the shape of the original tomogram.</p>"},{"location":"Usage/Training/","title":"Training","text":"<p>How to train your own model?</p>"}]}